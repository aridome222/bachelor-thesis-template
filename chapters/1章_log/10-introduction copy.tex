\chapter{はじめに}\label{cha:Introduction}
% 本研究では、レイアウトの不具合を可視化する、視覚的回帰テストツール\toolName の試作を行う。
% \toolName は、入力としてWebページのURLをコマンドライン上で受け取り、以下の画像を生成し、Webページ上で表示する。

% また、本研究で用いる「比較画像」、「テスト画像」を、以下に定義する。
研究背景の流れを、以下に示す。【文章にする＆参考文献で証拠をとる】
\begin{itemize}
    \item アプリケーションが大規模化する中で、信頼性を高めるにはバージョンアップ時にリグレッションテストする必要がある。
    \item 特に、Webアプリ開発では、特にビジュアルリグレッションテスト（UIテストのリグレッションテスト）が必要であり、
          機能のビジュアルリグレッションテストと、見た目のリグレッションテストの２つのテストがある。
    \item Web開発では、HTML要素を変更していないのに、画面上でそのHTML要素が変更されてしまうというレイアウトの不具合がある。
    \item レイアウトの不具合を見つけるには、HTMLコードの差分とレイアウトの差分との間における整合性の確認が必要である。
    \item ただし、既存のビジュアルリグレッションテストの研究では、全ての差分を表示してしまう。
    \item それに応じて、整合性の確認に手間と時間がかかってしまう。
\end{itemize}
そこで、本研究では、
HTMLコードの差分とレイアウトの差分との間における整合性の確認にかかる時間の削減を目的として、
レイアウト不具合箇所の可視化機能を持つ視覚的回帰テストツール\toolName を試作する。




大規模化に伴い、アプリケーションやソフトウェアの信頼性を確保するためには、最初のリリース時だけでなく、
新機能を追加したり、OSを更新したりするたびに、リグレッションテストを行う必要がある\cite{RegionDetect}。
特に、Web開発において、UIの見た目をテストするビジュアルリグレッションテスト(視覚的回帰テスト)が存在する。
既存の画像ベースの視覚的回帰テストでは、旧バージョンの画面と新バージョンの画面をピクセル単位で比較し、
差分のあるピクセルを強調表示することで、画面上の不具合を発見することをサポートする。

Web開発では、HTML要素を変更していないのに、画面上でそのHTML要素が変更されてしまうというレイアウトの不具合がある。



ピクセル単位で差分検出を行う既存の画像ベースの視覚的回帰テストには、以下の課題がある。
\begin{itemize}
    \item 全体的な変更による差分が見づらい
    \item 差分箇所が多くなるにつれ、レイアウトの不具合を見落としやすくなる
    \item 意図したレイアウトの変更であるかどうか判断できない
\end{itemize}

レイアウトの不具合を見つけるには、以下の操作を行う。
\begin{itemize}
    \item 差分画像を生成する
    \item HTMLコードの差分を出す
    \item 差分画像とHTMLコードの差分との間の整合性を確認する
\end{itemize}
しかし、3.において、時間と手間がかかる
そこで本研究では、
Webページのレイアウトの不具合を発見をするための、
変更前後のWebページにおける、
HTMLコードの差分とレイアウトの差分との間における整合性の確認にかかる時間削減を目的として、
レイアウト不具合箇所の可視化機能を持つ視覚的回帰テストツール\toolName(Mix Visual Regression Testing) を試作する。
\par
\toolName は、大きく分けて以下の3つの機能を持つ。
\begin{itemize}
    \item  Webページの変更前画像とWebページの変更後画像を比較して、
          変更前のWebページから削除された画面要素と変更後のWebページに追加された画面要素を可視化する
    \item 変更前後のWebページのHTMLコードを比較して、
          HTMLコードにおけるbody要素内の変更とstyle要素内の変更のどちらか、
          または両方の変更が適用された画面要素を可視化する
    \item Webページの変更前画像と変更後画像で、変更箇所によって、
          HTMLコードを変更していない画面要素にレイアウトの変更があった画面要素を可視化する
\end{itemize}
\par
本論文の構成を、以下に示す。\par
第2章では、本研究に必要となる前提知識を説明する。\par
第3章では、MixVRTの機能と外観について説明する。\par
第4章では、MixVRTの実装について説明する。\par
第5章では、適用例を用いて、MixVRTが正しく動作することを示す。\par
第6章では、MixVRTについて考察する。\par
第7章では、本研究のまとめと今後の課題について述べる。




% なお、本研究では、
% 画像比較に基づく差分箇所には、意図したレイアウトの変更と意図しないレイアウトの変更がある。
% 意図したレイアウトの変更はHTMLコードに基づいており、意図しないレイアウトの変更はHTMLコードに基づいていない。
% なお、本研究では、意図しないレイアウトの変更箇所を、「レイアウトの不具合箇所」と定義する。


% アプリケーションやソフトウェアの信頼性を確保するためには、最初のリリース時だけでなく、
% 新機能を追加したり、OSを更新したりするたびに、回帰テストを行う必要がある\cite{RegionDetect}。
% 回帰テストは、ソフトウェアに加えられた変更がシステムに悪影響を及ぼさないことを確認するために広く使用されている。
% しかし、ソフトウェアの新バージョンがリリースされるたびに同じテストを繰り返す必要があるため、対象となるソフトウェアの規模が大きくなるほど回帰テストに費やす労力も大きくなっている。
% したがって、この回帰テストを自動化することは、時間と労力を節約する効果的な方法となる。

% Web アプリケーションのような GUI ベースのアプリケーションのリグレッションテストでは、アプリケー ション画面が正しく表示されることを確認する必要があります。
% これには、アプリケーションのロジックが正しく動作し、計算結果が正しいかどうかの確認と、すべての アプリケーション画面において、画面要素が正しくレイアウトされているかどうかの確認の 2 つが含まれます。
% 前者は、Selenium *1、Appium *2、Sikuli *3 [8]などのテスト自動化ツールを用いて、ツールで実行するスクリプトに適切なアサーションを記述することで自動化できる。
% 対照的に、後者は、テスターが表示されたレイアウトを注意深く調べて比較する必要があり、これは難しい作業である。

% ビジュアル・リグレッション・テスト※4、略してVRTは、後者の確認作業を半自動化する手法である。
% VRTは、アプリケーションの2つの画面（通常は変更前後の対応する画面）の差異を、画面の画像情報や構造情報などに基づいて検出する。
% このように、2つのスクリーンショット画像を比較し、その情報のみを確認に用いるVRTを画像ベースVRTと呼ぶ。
% 画像ベースVRTは、アプリケーション画面のスクリーンショット画像があれば適用できるため、アプリケーションを実行する動作環境（OSやWebブラウザなど）に依存せずに利用できます。
% また、多くのテスト自動化ツールは、テスト対象のアプリケーションのスクリーンショットを撮影する方法を提供しているため、簡単に利用することができます。
% そのため、jsdiff *5やBlinkDiff *6のような画像ベースのVRTツールが数多く存在する。
% これらのツールは、2つの画像をピクセル単位で比較し、差異があるものを強調表示するため、テスト者は差異がある場所を簡単かつ明確に特定することができます。


% Webページの変更前後における画像比較に基づく差分箇所は、開発者の意図した変更であるかどうかを確認することができない。
% 差分箇所が意図した変更であるかどうかを開発者が確認するためには、
% 画像比較に基づく差分箇所から得られる視覚情報と、HTMLコードを見て得られるコード情報を
% 組み合わせることが効果的である。
% このデバッグ作業により、差分箇所が意図した変更であるかどうかを判定できるが、
% コード情報と視覚情報間の整合性の確認には、時間がかかる。
% \par
% そこで本研究では、コード情報と視覚情報間における整合性の確認にかかる時間の削減を目的として、
% レイアウトの副作用箇所強調表示(可視化)機能を持つ視覚的回帰テストツール\toolName を試作する。
% \par
% 【下記は2章に書く】\\
% 画像比較に基づく差分箇所には、意図したレイアウトの変更と意図しないレイアウトの変更がある。
% 意図したレイアウトの変更はHTMLコードに基づいており、意図しないレイアウトの変更はHTMLコードに基づいていない。
% なお、本研究では、意図しないレイアウトの変更箇所を、「レイアウトの不具合箇所」と定義する。

% \par
% 最初に、目視で変更前後のWebページを見比べて、不具合がないかどうかを見つけることの難しさを記述する。
% \begin{itemize}
%     \item Item 01
%     \item Item 02
% \end{itemize}
% $\\\\\\\\\\$
% 画像ベースの視覚的回帰テストの説明と、その問題点について記述する。
% \begin{itemize}
%     \item Item 01
%     \item Item 02
% \end{itemize}

% 本研究で試作するツールで課題を解決できることについて記述する。
% \begin{itemize}
%     \item Item 01
%     \item Item 02
% \end{itemize}


